{
  "name": "Functions - Existence and Aggregates",
  "description": "Tests for existence and aggregate functions",
  "tests": [
    {
      "name": "empty - empty collection",
      "expression": "{}.empty()",
      "input": [],
      "expected": [true],
      "tags": ["function", "existence", "empty"]
    },
    {
      "name": "empty - missing property",
      "expression": "missing.empty()",
      "input": [],
      "expected": [true],
      "tags": ["function", "existence", "empty"]
    },
    {
      "name": "empty - non-empty",
      "expression": "name.empty()",
      "input": [{ "name": "John" }],
      "expected": [false],
      "tags": ["function", "existence", "empty"]
    },
    {
      "name": "exists - non-empty",
      "expression": "name.exists()",
      "input": [{ "name": "John" }],
      "expected": [true],
      "tags": ["function", "existence", "exists"]
    },
    {
      "name": "exists - empty",
      "expression": "missing.exists()",
      "input": [],
      "expected": [false],
      "tags": ["function", "existence", "exists"]
    },
    {
      "name": "exists - with criteria true",
      "expression": "values.exists($this > 3)",
      "input": [{ "values": [1, 2, 3, 4, 5] }],
      "expected": [true],
      "tags": ["function", "existence", "exists", "criteria"]
    },
    {
      "name": "exists - with criteria false",
      "expression": "values.exists($this > 10)",
      "input": [{ "values": [1, 2, 3, 4, 5] }],
      "expected": [false],
      "tags": ["function", "existence", "exists", "criteria"]
    },
    {
      "name": "count - items",
      "expression": "values.count()",
      "input": [{ "values": [1, 2, 3] }],
      "expected": [3],
      "tags": ["function", "aggregate", "count"]
    },
    {
      "name": "count - empty",
      "expression": "{}.count()",
      "input": [],
      "expected": [0],
      "tags": ["function", "aggregate", "count"]
    },
    {
      "name": "all - criteria true",
      "expression": "values.all($this mod 2 = 0)",
      "input": [{ "values": [2, 4, 6, 8] }],
      "expected": [true],
      "tags": ["function", "aggregate", "all"]
    },
    {
      "name": "all - criteria false",
      "expression": "values.all($this > 5)",
      "input": [{ "values": [2, 4, 6, 8] }],
      "expected": [false],
      "tags": ["function", "aggregate", "all"]
    },
    {
      "name": "allTrue - all true",
      "expression": "values.allTrue()",
      "input": [{ "values": [true, true, true] }],
      "expected": [true],
      "tags": ["function", "aggregate", "boolean", "allTrue"]
    },
    {
      "name": "allTrue - contains false",
      "expression": "values.allTrue()",
      "input": [{ "values": [true, false, true] }],
      "expected": [false],
      "tags": ["function", "aggregate", "boolean", "allTrue"]
    },
    {
      "name": "anyTrue - contains true",
      "expression": "values.anyTrue()",
      "input": [{ "values": [false, true, false] }],
      "expected": [true],
      "tags": ["function", "aggregate", "boolean", "anyTrue"]
    },
    {
      "name": "anyTrue - all false",
      "expression": "values.anyTrue()",
      "input": [{ "values": [false, false, false] }],
      "expected": [false],
      "tags": ["function", "aggregate", "boolean", "anyTrue"]
    },
    {
      "name": "anyFalse - contains false",
      "expression": "values.anyFalse()",
      "input": [{ "values": [true, false, true] }],
      "expected": [true],
      "tags": ["function", "aggregate", "boolean", "anyFalse"]
    },
    {
      "name": "anyFalse - all true",
      "expression": "values.anyFalse()",
      "input": [{ "values": [true, true, true] }],
      "expected": [false],
      "tags": ["function", "aggregate", "boolean", "anyFalse"]
    },
    {
      "name": "allFalse - all false",
      "expression": "values.allFalse()",
      "input": [{ "values": [false, false, false] }],
      "expected": [true],
      "tags": ["function", "aggregate", "boolean", "allFalse"]
    },
    {
      "name": "allFalse - contains true",
      "expression": "values.allFalse()",
      "input": [{ "values": [false, true, false] }],
      "expected": [false],
      "tags": ["function", "aggregate", "boolean", "allFalse"]
    },
    {
      "name": "distinct - removes duplicates",
      "expression": "values.distinct()",
      "input": [{ "values": [1, 2, 2, 3, 3, 3, 4] }],
      "expected": [1, 2, 3, 4],
      "tags": ["function", "aggregate", "distinct"]
    },
    {
      "name": "isDistinct - no duplicates",
      "expression": "values.isDistinct()",
      "input": [{ "values": [1, 2, 3, 4] }],
      "expected": [true],
      "tags": ["function", "aggregate", "isDistinct"]
    },
    {
      "name": "isDistinct - has duplicates",
      "expression": "values.isDistinct()",
      "input": [{ "values": [1, 2, 2, 3] }],
      "expected": [false],
      "tags": ["function", "aggregate", "isDistinct"]
    }
  ]
}